---
title: 'Leetcode SQL Interview Answer '
author: Chengsheng Deng
date: '2020-09-18'
slug: leetcode-sql-interview-answer
categories: []
tags:
  - SQL
feature_image: ''
---



<p><strong>178 Rank Scores</strong></p>
<ul>
<li>Level: Medium</li>
</ul>
<p>SELECT Score, </br>
DENSE_RANK() OVER(ORDER BY Score DESC) ‘Rank’ </br>
FROM Scores </br></p>
<ul>
<li>Please know the difference between <code>DENSE_RANK()</code> and <code>RANK()</code></li>
</ul>
<p><strong>177 Nth Highest Salary</strong></p>
<ul>
<li>Level: Medium </br></li>
</ul>
<pre><code>CREATE FUNCTION getNthHighestSalary(N INT) RETURNS INT 
BEGIN 
  RETURN ( 
      SELECT DISTINCT a.Salary 
      FROM (
             SELECT Salary, 
             DENSE_RANK() OVER(ORDER BY Salary DESC) rnk 
             FROM Employee) a 
      WHERE a.rnk = n 
  ); 
END </code></pre>
<ul>
<li>We use subquery here to get the rank of the salary with the decreasing order first. </br></li>
<li>Then we select the <code>distinct</code> salary with the <code>WHERE</code> clause to filter the Nth rank because we want the Nth highest salary. That would be a unique value. </br></li>
</ul>
<p><strong>184 Department Highest Salary</strong></p>
<ul>
<li>Level: Medium </br></li>
</ul>
<pre><code>WITH temp AS ( SELECT e.Name AS emp, 
                      e.Salary, 
                      e.DepartmentId, 
                      d.Name,   
                      RANK() OVER(PARTITION BY e.DepartmentId ORDER BY e.Salary DESC) rnk   
      FROM Employee e  
      JOIN Department d  
      ON e.DepartmentId = d.Id)  

SELECT Name AS Department, emp AS Employee, Salary 
FROM temp  
WHERE rnk = 1 </code></pre>
