---
title: 'Leetcode SQL Interview Answer '
author: Chengsheng Deng
date: '2020-09-18'
slug: leetcode-sql-interview-answer
categories: []
tags:
  - SQL
feature_image: ''
---



<p><strong>178 Rank Scores</strong></p>
<ul>
<li>Level: Medium</li>
</ul>
<p>SELECT Score, </br>
DENSE_RANK() OVER(ORDER BY Score DESC) ‘Rank’ </br>
FROM Scores </br></p>
<ul>
<li>Please know the difference between <code>DENSE_RANK()</code> and <code>RANK()</code></li>
</ul>
<p><strong>177 Nth Highest Salary</strong></p>
<ul>
<li>Level: Medium </br></li>
</ul>
<p>CREATE FUNCTION getNthHighestSalary(N INT) RETURNS INT </br>
BEGIN </br>
RETURN ( </br>
SELECT DISTINCT a.Salary FROM (SELECT Salary, DENSE_RANK() OVER(ORDER BY Salary DESC) rnk FROM Employee) a </br>
WHERE a.rnk = n </br>
); </br>
END</p>
<ul>
<li>We use subquery here to get the rank of the salary with the decreasing order first. </br></li>
<li>Then we select the <code>distinct</code> salary with the <code>WHERE</code> clause to filter the Nth rank because we want the Nth highest salary. That would be a unique value. </br></li>
</ul>
<p><strong>184 Department Highest Salary</strong></p>
<ul>
<li>Level: Medium </br></li>
</ul>
<p>WITH temp AS ( SELECT e.Name AS emp, e.Salary, e.DepartmentId, d.Name, </br>
RANK()OVER(PARTITION BY e.DepartmentId ORDER BY e.Salary DESC) rnk </br>
FROM Employee e </br>
JOIN Department d </br>
ON e.DepartmentId = d.Id ) </br></p>
<p>SELECT Name AS Department, emp AS Employee, Salary </br>
FROM temp </br>
WHERE rnk = 1 </br></p>
