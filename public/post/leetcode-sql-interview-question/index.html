<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    
    
    <title>Leetcode SQL Interview Question  · Chengsheng&#39;s Blog</title>

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    
    <link rel="stylesheet" href="/style.main.min.5ea2f07be7e07e221a7112a3095b89d049b96c48b831f16f1015bf2d95d914e5.css" />

</head>
<body class=" post-template ">

    <div class="site-wrapper">

<header class="site-header"><div class="outer site-nav-main">
    <div class="inner"><nav class="site-nav">
    <div class="site-nav-left">
        
            <a class="site-nav-logo" href="/">Chengsheng&#39;s Blog</a>
        
        
        <div class="site-nav-content">
            <ul class="nav" role="menu">
                
            </ul>
        </div>
        
    </div>
</nav>

</div>
</div></header>

<main id="site-main" class="site-main outer">
    <div class="inner">

        <article class="post-full post  no-image ">

            <header class="post-full-header">

                
                    
                    <section class="post-full-tags">
                        <a href="/tags/sql">SQL</a>
                    </section>
                

                <h1 class="post-full-title">Leetcode SQL Interview Question </h1>

                

                <div class="post-full-byline">
                    <section class="post-full-byline-content">

                        <ul class="author-list">
    <li class="author-list-item">
        <div class="author-card">
            <div class="author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg></div>
            <div class="author-info">
                <div class="author-info">
                    <h2>Chengsheng Deng</h2>
                </div>
            </div>
        </div>
        <a href="#" class="author-avatar author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg></a>
    </li>
</ul>

                        <section class="post-full-byline-meta">
                            
                                <h4 class="author-name">Chengsheng Deng</h4>
                            
                            <div class="byline-meta-content">
                                <time class="byline-meta-date" datetime="2020-129-09">18 September 2020</time>
                                <span class="byline-reading-time"><span class="bull">&bull;</span> 3 min read</span>
                            </div>
                        </section>

                    </section>


                </div>
            </header>

            

            <section class="post-full-content">
                <div class="post-content">
                    


<div id="rank-window-function" class="section level2">
<h2>RANK() &amp; Window Function</h2>
<div id="rank-scores" class="section level4">
<h4>178 Rank Scores </br></h4>
<ul>
<li>Level: Medium </br></li>
</ul>
<p>Write a SQL query to rank scores. If there is a tie between two scores, both should have the same ranking. Note that after a tie, the next ranking number should be the next consecutive integer value. In other words, there should be no “holes” between ranks. </br></p>
<p>+—-+——-+</br>
| Id | Score |</br>
+—-+——-+</br>
| 1 | 3.50 |</br>
| 2 | 3.65 |</br>
| 3 | 4.00 |</br>
| 4 | 3.85 |</br>
| 5 | 4.00 |</br>
| 6 | 3.65 |</br>
+—-+——-+</br></p>
<p>For example, given the above Scores table, your query should generate the following report (order by highest score): </br></p>
<p>+——-+———+ </br>
| score | Rank | </br>
+——-+———+ </br>
| 4.00 | 1 | </br>
| 4.00 | 1 | </br>
| 3.85 | 2 | </br>
| 3.65 | 3 | </br>
| 3.65 | 3 | </br>
| 3.50 | 4 | </br>
+——-+———+ </br></p>
<p>Important Note: For MySQL solutions, to escape reserved words used as column names, you can use an apostrophe before and after the keyword. For example ‘Rank’.</br></p>
<p><em>Answer</em> : <a href="https://chengshengblog.netlify.app/post/leetcode-sql-interview-answer/" class="uri">https://chengshengblog.netlify.app/post/leetcode-sql-interview-answer/</a></p>
</div>
<div id="nth-highest-salary" class="section level4">
<h4>177 Nth Highest Salary </br></h4>
<ul>
<li>Level: Medium </br></li>
</ul>
<p>Write a SQL query to get the nth highest salary from the Employee table. </br></p>
<p>+—-+——–+ </br>
| Id | Salary | </br>
+—-+——–+ </br>
| 1 | 100 | </br>
| 2 | 200 | </br>
| 3 | 300 | </br>
+—-+——–+ </br></p>
<p>For example, given the above Employee table, the nth highest salary where n = 2 is 200. If there is no nth highest salary, then the query should return null. </br></p>
<p>+————————+ </br>
| getNthHighestSalary(2) | </br>
+————————+ </br>
| 200 | </br>
+————————+ </br></p>
<p><em>Answer</em> : <a href="https://chengshengblog.netlify.app/post/leetcode-sql-interview-answer/" class="uri">https://chengshengblog.netlify.app/post/leetcode-sql-interview-answer/</a> </br></p>
</div>
<div id="department-highest-salary" class="section level4">
<h4>184 Department Highest Salary </br></h4>
<p>The Employee table holds all employees. Every employee has an Id, a salary, and there is also a column for the department Id. </br></p>
<p>+—-+——-+——–+————–+ </br>
| Id | Name | Salary | DepartmentId | </br>
+—-+——-+——–+————–+ </br>
| 1 | Joe | 70000 | 1 | </br>
| 2 | Jim | 90000 | 1 | </br>
| 3 | Henry | 80000 | 2 | </br>
| 4 | Sam | 60000 | 2 | </br>
| 5 | Max | 90000 | 1 | </br>
+—-+——-+——–+————–+ </br></p>
<p>The Department table holds all departments of the company. </br></p>
<p>+—-+———-+ </br>
| Id | Name | </br>
+—-+———-+ </br>
| 1 | IT | </br>
| 2 | Sales | </br>
+—-+———-+ </br></p>
<p>Write a SQL query to find employees who have the highest salary in each of the departments. For the above tables, your SQL query should return the following rows (order of rows does not matter). </br></p>
<p>+————+———-+——–+ </br>
| Department | Employee | Salary | </br>
+————+———-+——–+ </br>
| IT | Max | 90000 | </br>
| IT | Jim | 90000 | </br>
| Sales | Henry | 80000 | </br>
+————+———-+——–+ </br></p>
<p>Explanation: </br></p>
<p>Max and Jim both have the highest salary in the IT department and Henry has the highest salary in the Sales department. </br></p>
<p><em>Answer</em> : <a href="https://chengshengblog.netlify.app/post/leetcode-sql-interview-answer/" class="uri">https://chengshengblog.netlify.app/post/leetcode-sql-interview-answer/</a> </br></p>
</div>
</div>

                </div>
            </section>

        </article>

    </div>
</main>
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
    
    <article class="read-next-card">
        <header class="read-next-card-header">
            <h3><span>More in</span> <a href="/tags/sql">SQL</a></h3>
        </header>
        <div class="read-next-card-content">
            <ul>
                
            </ul>
        </div>
    </article>
<article class="post-card post
 no-image
 ">

        
    
        <div class="post-card-content">
    
            <a class="post-card-content-link" href="/post/leetcode-sql-interview-questions/">
    
                <header class="post-card-header">
                    
                        
                        <div class="post-card-primary-tag">SQL</div>
                    

                    <h2 class="post-card-title">Leetcode SQL Interview Questions Conclusion</h2>
                </header>
    
                <section class="post-card-excerpt">
                    <p>In this section, I conclude the date,times,problems, and key points for the Leetcode SQL problems.It shows my journey to struggle with SQL. Please enjoy visiting!
  题号 难易度 题目内容 第二次做题时间 做题情况 第三次做题时间 做题情况.1 第四次做题时间 做题情况.2 相似题型.考点 X    176 Easy Second Highest Salary 2020-08-04 思路正确，小细节没注意。 2020-08-18 能做出题目，此题考的频率较高，需要反复练习。    NA  178 Medium Rank Scores 2020-08-04 基本可以解答出题目，需注意DENSE_RANK 和RANK的区别。 可参考1303 关于OVER（PARTITION BY） 的用法 2020-08-18 能够做出题目， 注意命名新column 避免reserved word 的方法。 2020-08-23 能做出题目，充分理解考点 177,178,184, 1077 ，574，1070 ,1112，1164，1174，1285,1355考点类似，都跟RANK 有关。 NA  175 Easy Combine Two Table 2020-08-04 可以解答出题目，注意是JOIN 还是LEFT JOIN 2020-08-23 能做出题目，题目本身较为基础。   175，570 , 580，1158，1164，1421考点是区分JOIN 还是LEFT JOIN NA  181 Easy Employees Earning More Than Their Managers 2020-08-04 可以做出题目，注意一个表的时候可以JOIN自身 2020-08-27 能做出题目，题目本身较为基础。   181,612,614，1126，1149, 考点是SELF JOIN NA  182 Easy Duplicate Emails 2020-08-04 可以做出题目，注意运用Group BY 和 COUNT 当遇到筛选数量的时候 2020-08-27 能做出题目，题目本身较为基础。   考点是GROUPBY 和 COUNT 基础考点。 182，511 ,585，596，602，1045，1132都有GROUP BY 可一起复习。 (585,602有相似点可一起复习） NA  183 Easy Customer Who Never Order 2020-08-05 能做出题目，对JOIN 的运用没什么问题。      NA  196 Easy Delete Duplicate Emails 2020-08-05 没掌握思路，还得反复练习      NA  197 Easy Rising Temperature 2020-08-05 可以做出题目。 遇到一个表，行之间需要比较的时候，可以用JOIN      NA  511 Easy Game Play Analysis I 2020-08-05 想法过于复杂，没做出来，实际上一行code就可以解决 2020-08-09 仍然有错误，注意first_login date 可以用 min(date) 来筛选。 2020-08-23 能做出题目， 基本没什么问题。 考点较为基础， GROUP BY 后取最小MIN NA  577 Easy Employee Bonus 2020-08-05 可以做出题目。题目考点就是LEFT JOIN 然后筛选条件。      NA  584 Easy Find Customer Referee 2020-08-07 能够做出题目。注意条件筛选和NULL      NA  586 Easy Customer Placing the Largest Number of Orders 2020-08-07 能做出题目，注意排序      NA  595 Easy Big Countries 2020-08-07 简单      NA  596 Easy Classes More Than 5 Students 2020-08-07 能做出题目，但是要注意重复的选项只能算一次。 DISTINCT function 2020-08-30 能做出题目, 题目本身比较基础，注意边界条件。   考点是GROUPBY 和 COUNT 基础考点。 182，511 ,585, 596，602，1045，1132都有GROUP BY 可一起复习。(585,602有相似点可一起复习） NA  1075 Easy Project Employee I 2020-08-07 题目较容易，能做出题目。 注意筛选条件就好。      NA  1076 Easy Project Employee II 2020-08-09 不能做出题目，需要注意RANK function ，以及subquery      NA  1082 Easy Sales Analysis I 2020-08-09 能做出题目，题目解法与1076 类似，可以参照。      NA  1083 Easy Sales Analysis II 2020-08-09 不能做出题目，没有思路。 要注意运用subquery 进行条件筛选      NA  1084 Easy Sales Analysis III 2020-08-09 不能做出题目，没有思路。题目与1083 类似，都是条件筛选，也需要用subquery， 但是可以不用JOIN。      NA  1113 Easy Reported Posts 2020-08-09 能做出题目。 运用到的function 就是COUNT(), DISTINCT(), 还有GROUP BY 和 WHERE 筛选。      NA  1141 Easy Users Activity for the Past 30 Days I 2020-08-11 能做出题目，注意条件筛选，运用到的function 有GROUPBY(), DISTINCT() 和COUNT（），DATEDIFF()      NA  1142 Easy Users Activity for the Past 30 Days II 2020-08-11 此题与1141类似，可一起复习，注意不用GROUPBY      NA  1148 Easy Article Views I 2020-08-12 能做出题目，较简单。 运用到的function WHERE 和 DISTINCT      NA  1173 Easy Immediate Food Delivery I 2020-08-12 能做出题目，注意计算就好。 Subquery      NA  1211 Easy Queries Quality and Percentage 2020-08-12 还是稍微有点问题，要注意运用CASE WHEN… ELSE FUNCTION 列出次数后再用SUM 算和      NA  1251 Easy Average Selling Price 2020-08-12 能够做出题目,此题难度一般,需要注意JOIN 后ON 有两个条件.</p>
                </section>
    
            </a>

            <footer class="post-card-meta">
                    <ul class="author-list">
                        <li class="author-list-item">
                            <div class="author-name-tooltip">Chengsheng Deng</div>
                            <a href="https://test.com" class="static-avatar author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg></a>
                        </li>
                    </ul>
                    <div class="post-card-byline-content">
                        <span>Chengsheng Deng</span>
                        <span class="post-card-byline-date"><time datetime="2020-129-09">18 September 2020</time>
                            <span class="bull">&bull;</span> 6 min read</span>
                    </div>
                </footer>
    
        </div>

</article>
    

            <article class="post-card post
 no-image
 ">

        
    
        <div class="post-card-content">
    
            <a class="post-card-content-link" href="/post/leetcode-sql-interview-answer/">
    
                <header class="post-card-header">
                    
                        
                        <div class="post-card-primary-tag">SQL</div>
                    

                    <h2 class="post-card-title">Leetcode SQL Interview Answer </h2>
                </header>
    
                <section class="post-card-excerpt">
                    <p>178 Rank Scores
 Level: Medium  SELECT Score,  DENSE_RANK() OVER(ORDER BY Score DESC) ‘Rank’  FROM Scores 
 Please know the difference between DENSE_RANK() and RANK()  177 Nth Highest Salary
 Level: Medium   CREATE FUNCTION getNthHighestSalary(N INT) RETURNS INT BEGIN RETURN ( SELECT DISTINCT a.Salary FROM ( SELECT Salary, DENSE_RANK() OVER(ORDER BY Salary DESC) rnk FROM Employee) a WHERE a.rnk = n ); END   We use subquery here to get the rank of the salary with the decreasing order first.</p>
                </section>
    
            </a>

            <footer class="post-card-meta">
                    <ul class="author-list">
                        <li class="author-list-item">
                            <div class="author-name-tooltip">Chengsheng Deng</div>
                            <a href="https://test.com" class="static-avatar author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg></a>
                        </li>
                    </ul>
                    <div class="post-card-byline-content">
                        <span>Chengsheng Deng</span>
                        <span class="post-card-byline-date"><time datetime="2020-129-09">18 September 2020</time>
                            <span class="bull">&bull;</span> 1 min read</span>
                    </div>
                </footer>
    
        </div>

</article>
    
        </div>
    </div>
</aside>


        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="/">Chengsheng&#39;s Blog</a> &copy; 2020</section>
                <nav class="site-footer-nav">
                    <a href="/">Latest Posts</a>
                    
                    
                    
                    <a href="https://jonathanjanssens.com" target="_blank" rel="noopener" style="opacity: 0.5;">Hugo Casper3 by Jonathan Janssens</a>
                </nav>
            </div>
        </footer>

    </div>

</body>
</html>